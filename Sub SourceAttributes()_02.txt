Sub SourceAttributes()
    Dim wsSource As Worksheet
    Dim wsTarget As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim lookupValue As Variant
    Dim result As Variant

    ' Set worksheets
    Set wsSource = ThisWorkbook.Sheets("HES Response")
    Set wsTarget = ThisWorkbook.Sheets("Parallel_Test_Report")

    ' Find last row in target sheet (column G)
    lastRow = wsTarget.Cells(wsTarget.Rows.Count, "G").End(xlUp).Row

    ' Turn off screen updating and automatic calculation for performance
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.EnableEvents = False

    ' Error handling
    On Error GoTo ErrorHandler

    ' Perform VLOOKUPs for each row starting from row 2
    For i = 2 To lastRow
        lookupValue = wsTarget.Cells(i, 7).Value ' Column G

        If lookupValue <> "" Then
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 10, False)
            wsTarget.Cells(i, 112).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 34, False)
            wsTarget.Cells(i, 113).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 38, False)
            wsTarget.Cells(i, 114).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 41, False)
            wsTarget.Cells(i, 115).Value = FormatResult(result, True)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 40, False)
            wsTarget.Cells(i, 116).Value = FormatResult(result, True)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 44, False)
            wsTarget.Cells(i, 117).Value = FormatResult(result, True)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 45, False)
            wsTarget.Cells(i, 118).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 42, False)
            wsTarget.Cells(i, 119).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 43, False)
            wsTarget.Cells(i, 120).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 47, False)
            wsTarget.Cells(i, 121).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 39, False)
            wsTarget.Cells(i, 122).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 46, False)
            wsTarget.Cells(i, 123).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 14, False)
            wsTarget.Cells(i, 124).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 15, False)
            wsTarget.Cells(i, 125).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 16, False)
            wsTarget.Cells(i, 126).Value = FormatResult(result, False)

            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 17, False)
            wsTarget.Cells(i, 127).Value = FormatResult(result, False)
        End If
    Next i

    ' Restore settings
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.EnableEvents = True

    MsgBox "VLOOKUPs completed successfully for " & (lastRow - 1) & " rows!", vbInformation
    Exit Sub

ErrorHandler:
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    MsgBox "Error occurred in row " & i & ": " & Err.Description, vbCritical

    ' ðŸ§  Local helper function placed before End Sub
    Function FormatResult(val As Variant, formatDecimal As Boolean) As String
        If IsError(val) Or IsEmpty(val) Or Trim(val) = "" Then
            FormatResult = "N/A"
        ElseIf formatDecimal Then
            FormatResult = Format(val, "0.00")
        Else
            FormatResult = val
        End If
    End Function
End Sub
