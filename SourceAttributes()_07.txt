Sub SourceAttributes()
    Dim wsSource As Worksheet
    Dim wsTarget As Worksheet
    Dim lastRow As Long
    Dim i As Long
    Dim lookupValue As Variant
    Dim result As Variant
    
    ' Set worksheets
    Set wsSource = ThisWorkbook.Sheets("HES Response")
    Set wsTarget = ThisWorkbook.Sheets("Parallel_Test_Report")
    
    ' Find last row in target sheet (column G)
    lastRow = wsTarget.Cells(wsTarget.Rows.Count, "G").End(xlUp).Row
    
    ' Turn off screen updating and automatic calculation for performance
    Application.ScreenUpdating = False
    Application.Calculation = xlCalculationManual
    Application.EnableEvents = False
    
    ' Error handling
    On Error GoTo ErrorHandler
    
    ' Perform VLOOKUPs for each row starting from row 2
    For i = 2 To lastRow
        lookupValue = wsTarget.Cells(i, 7).Value ' Column G
        
        If lookupValue <> "" Then
            ' Column DH (VLOOKUP column 10)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 10, False)
            wsTarget.Cells(i, 112).Value = FormatResult(result)
            
            ' Column DI (VLOOKUP column 34)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 34, False)
            wsTarget.Cells(i, 113).Value = FormatResult(result)
            
            ' Column DJ (VLOOKUP column 38)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 38, False)
            wsTarget.Cells(i, 114).Value = FormatResult(result)
            
            ' Column DK (VLOOKUP column 41)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 41, False)
            wsTarget.Cells(i, 115).Value = FormatResult(result)
            
            ' Column DL (VLOOKUP column 40)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 40, False)
            wsTarget.Cells(i, 116).Value = FormatResult(result)
            
            ' Column DM (VLOOKUP column 44)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 44, False)
            wsTarget.Cells(i, 117).Value = FormatResult(result)
            
            ' Column DN (VLOOKUP column 45)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 45, False)
            wsTarget.Cells(i, 118).Value = FormatResult(result)
            
            ' Column DO (VLOOKUP column 42)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 42, False)
            wsTarget.Cells(i, 119).Value = FormatResult(result)
            
            ' Column DP (VLOOKUP column 43)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 43, False)
            wsTarget.Cells(i, 120).Value = FormatResult(result)
            
            ' Column DQ (VLOOKUP column 47)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 47, False)
            wsTarget.Cells(i, 121).Value = FormatResult(result)
            
            ' Column DR (VLOOKUP column 39)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 39, False)
            wsTarget.Cells(i, 122).Value = FormatResult(result)
            
            ' Column DS (VLOOKUP column 46)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 46, False)
            wsTarget.Cells(i, 123).Value = FormatResult(result)
            
            ' Column DT (VLOOKUP column 14)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 14, False)
            wsTarget.Cells(i, 124).Value = FormatResult(result)
            
            ' Column DU (VLOOKUP column 15)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 15, False)
            wsTarget.Cells(i, 125).Value = FormatResult(result)
            
            ' Column DV (VLOOKUP column 16)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 16, False)
            wsTarget.Cells(i, 126).Value = FormatResult(result)
            
            ' Column DW (VLOOKUP column 17)
            result = Application.VLookup(lookupValue, wsSource.Range("B:CK"), 17, False)
            wsTarget.Cells(i, 127).Value = FormatResult(result)
        Else
            ' If lookup value is blank, set all target cells to #N/A
            wsTarget.Cells(i, 112).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 113).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 114).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 115).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 116).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 117).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 118).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 119).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 120).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 121).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 122).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 123).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 124).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 125).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 126).Value = CVErr(xlErrNA)
            wsTarget.Cells(i, 127).Value = CVErr(xlErrNA)
        End If
    Next i
    
    ' Restore settings
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
    MsgBox "VLOOKUPs completed successfully for " & (lastRow - 1) & " rows!", vbInformation
    
    Exit Sub
    
ErrorHandler:
    ' Restore settings even if error occurs
    Application.Calculation = xlCalculationAutomatic
    Application.ScreenUpdating = True
    Application.EnableEvents = True
    
    MsgBox "Error occurred in row " & i & ": " & Err.Description, vbCritical
End Sub

' Helper function to format results - only shows 0 as 0, everything else as #N/A
Private Function FormatResult(val As Variant) As Variant
    If IsError(val) Then
        ' Return #N/A for any VLOOKUP errors
        FormatResult = CVErr(xlErrNA)
    ElseIf IsEmpty(val) Or val = "" Or Trim(val) = "" Then
        ' Return #N/A for blank/empty values
        FormatResult = CVErr(xlErrNA)
    ElseIf IsNumeric(val) Then
        If val = 0 Then
            ' Return exactly 0 for zero values
            FormatResult = 0
        Else
            ' Return #N/A for any non-zero numeric values
            FormatResult = CVErr(xlErrNA)
        End If
    Else
        ' Return #N/A for any non-numeric, non-zero values
        FormatResult = CVErr(xlErrNA)
    End If
End Function